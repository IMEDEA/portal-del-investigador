<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Instalación - Portal del Investigador - Documentación</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <!-- Favicon -->
    <link rel="shortcut icon" href="//static.ull.es/v3/dist/img/favicon.ico">
    <!--[if IE]><link rel="shortcut icon" href="//static.ull.es/v3/dist/img/favicon.ico"><![endif]-->
    <!-- Touchicon -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="//static.ull.es/v3/dist/img/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="//static.ull.es/v3/dist/img/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="//static.ull.es/v3/dist/img/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="//static.ull.es/v3/dist/img/apple-touch-icon-57-precomposed.png">

<link rel="canonical" href="/investigacion/instalacion.html">

        <meta name="author" content="Universidad de La Laguna" />
        <meta name="description" content="Instalar/Actualizar el paquete VIRTUALENV sudo apt-get install python-pip pip show virtualenv sudo pip install --upgrade virtualenv pip show virtualenv Crear y activar un VIRTUALENV para el proyecto mkdir -p virtualenv cd virtualenv virtualenv --no-site-packages . source bin/activate Descargar el repositorio git clone git@gitlab.stic.ull.es:investigacion/portal-de-investigacion ..." />

    <meta property="og:site_name" content="Portal del Investigador - Documentación" />
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Instalación"/>
    <meta property="og:url" content="/investigacion/instalacion.html"/>
    <meta property="og:description" content="Instalar/Actualizar el paquete VIRTUALENV sudo apt-get install python-pip pip show virtualenv sudo pip install --upgrade virtualenv pip show virtualenv Crear y activar un VIRTUALENV para el proyecto mkdir -p virtualenv cd virtualenv virtualenv --no-site-packages . source bin/activate Descargar el repositorio git clone git@gitlab.stic.ull.es:investigacion/portal-de-investigacion ..." />


    <!-- ULL -->
    <link rel="stylesheet" href="//static.ull.es/v3/dist/css/ull.min.css" type="text/css"/>

    <link href="/investigacion/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="/investigacion/theme/css/style.css" type="text/css"/>
    <noscript><style> .jsonly { display: none } </style></noscript>


</head>
<body>

<div class="navbar navbar-default navbar-ull" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-app-collapse">
                <span class="sr-only">Desplegar menú de aplicación</span>
                <span class="fa fa-bars fa-stack"></span>
            </button>
<!--
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
                <span class="sr-only">Desplegar menú de navegación</span>
                <span class="fa fa-link fa-stack"></span>
            </button>
-->
            <a class="navbar-brand" href="http://www.ull.es" title="Universidad de La Laguna">Universidad de La Laguna</a>
        </div>
<!--
        <div class="collapse navbar-collapse navbar-main-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contacto <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a target="_blank" href="http://www.ull.es"><i class="fa fa-globe"></i> Página Web ULL</a></li>
                        <li><a target="_blank" title="Formulario de contacto" href="http://www.ull.es/view/institucional/ull/Contacto_3/es"><i class="fa fa-list-alt"></i> Formulario de contacto</a></li>
                        <li><a target="_blank" title="Teléfonos" href="http://www.ull.es/view/institucional/ull/Telefonos/es"><i class="fa fa-phone"></i> Directorio telefónico</a></li>
                        <li class="divider"></li>
                        <li>
                            <ul class="rrss text-muted list-inline">
                                <li><a target="_blank" href="http://www.facebook.com/universidaddelalaguna"><i class="fa fa-facebook-square"></i></a></li>
                                <li><a target="_blank" href="http://www.tuenti.com/#m=Page&amp;func=index&amp;page_key=1_160_68944913"><i class="fa fa-tumblr-square"></i></a></li>
                                <li><a target="_blank" href="http://twitter.com/CanalULL"><i class="fa fa-twitter-square"></i></a></li>
                                <li><a target="_blank" href="http://www.linkedin.com/groups/Universidad-Laguna-2656178"><i class="fa fa-linkedin-square"></i></a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
-->
    </div>
</div>
<div class="navbar navbar-default navbar-app" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
                <ol class="breadcrumb">
                    <li class="active"><a href="/investigacion/">Portal del Investigador - Documentación</a></li>
                </ol>
        </div>
        <div class="collapse navbar-collapse navbar-app-collapse">
            <ul class="nav navbar-nav navbar-right">
                         <li><a href="/investigacion/">Home</a></li>
                         <li class="active"><a href="/investigacion/instalacion.html">Instalación</a></li>
                         <li><a href="/investigacion/other.html">Other</a></li>
                         <li><a href="/investigacion/team.html">Team</a></li>
                         <li><a href="/investigacion/contacto.html">Contacto</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<div class="container-fluid">
    <div class="row">
        <div class="col-md-9" role="main">

    <section id="content" class="body">
        <h1 class="entry-title">Instalación</h1>
        
        <div class="entry-content">
            <ol>
    <li> Instalar/Actualizar el paquete VIRTUALENV</li>
<pre>
sudo apt-get install python-pip
pip show virtualenv 
sudo pip install --upgrade virtualenv   
pip show virtualenv
</pre>

    <li>Crear y activar un VIRTUALENV para el proyecto</li>
<pre>
mkdir -p virtualenv
cd virtualenv
virtualenv --no-site-packages .
source bin/activate
</pre>

    <li>Descargar el repositorio</li>
<pre>
git clone git@gitlab.stic.ull.es:investigacion/portal-de-investigacion.git
</pre>


    <li>Instalar dependencia (desde la raíz del proyecto y con el virtualenv activo)</li>
<pre>
pip install -U distribute
sudo apt-get install libmysqlclient-dev postgresql postgresql-client postgresql-contrib 
                     libpq-dev libxml2-dev libxslt1-dev python-dev
pip install -r requirements.txt
</pre>

    <li>Configurar PostgreSQL
        <ul>
            <li>Cambiar contraseña del usuario postgres </li>   
<pre>
sudo su postgres -c psql
ALTER USER postgres WITH PASSWORD 'contraseña';
</pre>

            <li>Cambiar contraseña del usuario postgres en el sistema </li>
<pre>
sudo passwd -d postgres
sudo su postgres -c passwd
</pre>

            <li>Crear usuario y base de datos</li>
<pre>
sudo su postgres -c psql
CREATE USER user WITH PASSWORD 'contraseña';
ALTER USER <user> createdb;
CREATE DATABASE database
    ENCODING = 'UTF8'
    TABLESPACE = pg_default
    LC_COLLATE = 'es_ES.UTF-8'
    LC_CTYPE = 'es_ES.UTF-8'
    CONNECTION LIMIT = -1;
GRANT CONNECT, TEMPORARY ON DATABASE database TO user;
GRANT ALL ON DATABASE database TO user;     
</pre>

            <li>Probar el acceso</li>
<pre>
psql -U <user> -W <database>        
</pre>
        </ul>
    </li>

    <li>Crear el esquema de la base de datos</li>
<pre>
python manage.py makemigrations     
python manage.py migrate
</pre>
    <li> Configurar Settings Local</li>
    <p>
    En cada una de las aplicaciones existe un fichero de ejemplo (settings_local-sample.py) que define las configuraciones que necesitan ser modificadas, por lo que se recomienda su uso como punto de partida. 
    </p>
<pre>
cp settings_local-sample.py settings_local.py
</pre>
    <ul>

        <!-- Configuración del Proyecto -->

        <li> Settings Local de Investigación (investigacion/settings_local.py)</li>
        <div class="row">
            <div class="col-md-12">
                <div class="section">
                <ul class="nav nav-tabs header">
                    <li class="active">Configuración</li>
                </ul>
                    <div class="content">
                        <div class="row-fluid">
                            <table class="table table-striped table-condensed">
                                <tr>
                                    <th>VARIABLE</th>
                                    <th>DESCRIPCIÓN</th>
                                </tr>
                                <tr>
                                    <td> BASE_URL </td>
                                    <td> URL que se emplea como base del proyecto (el index del proyecto es una url externa) </td>
                                </tr>
                                <tr>
                                    <td> OLD_PORTAL_URL </td>
                                    <td> URL del antiguo Portal del Investigador (actualmente empleada en la aplicación Statistics)</td>
                                </tr>
                                <tr>
                                    <td> SECRET_KEY </td>
                                    <td>Clave secreta de una instalación particular de Django. Se utiliza para proporcionar la firma criptográfica, se debe establecer en un valor impredecible y único </td>
                                </tr>
                                <tr>
                                    <td> DEBUG </td>
                                    <td> Booleano que activa/desactiva el modo de depuración </td>
                                </tr>   
                                <tr>
                                    <td> TEMPLATE_DEBUG </td>
                                    <td> Booleano que activa/desactiva el modo de depuración </td>
                                </tr>
                                <tr>
                                    <td> DEVEL </td>
                                    <td> Booleano que indica si se está o no en el Entorno de Desarrollo </td>
                                </tr>
                                <tr>
                                    <td> ADMINS </td>
                                    <td> Tupla de las personas que reciben las notificaciones de error </td>
                                </tr>
                                <tr>
                                    <td> SUPPORT </td>
                                    <td> Nombre del Departamento de Soporte </td>
                                </tr>
                                <tr>
                                    <td> EMAIL_SUPPORT </td>
                                    <td> Correo Electrónico del Departamento de Soporte </td>
                                </tr>
                                <tr>
                                    <td> CAS_SERVER_URL </td>
                                    <td> URL del Servicio de Autenticación (CAS) </td>
                                </tr>
                                <tr>
                                    <td> WS_SERVER_UR </td>
                                    <td> URL base del Servicio de Web Services </td>
                                </tr>           
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="section">
                <ul class="nav nav-tabs header">
                    <li class="active">Base de datos</li>
                </ul>
                    <div class="content">
                        <div class="row-fluid">
                            <strong>Base de datos por Defecto </strong>
                            <table class="table table-striped table-condensed">
                                <tr>
                                    <th>VARIABLE</th>
                                    <th>DESCRIPCIÓN</th>
                                </tr>
                                <tr>
                                    <td> DATABASES['default']['NAME'] </td>
                                    <td> Nombre de la Base de Datos </td>
                                </tr>
                                <tr>
                                    <td> DATABASES['default']['USER'] </td>
                                    <td> Usuario de la Base de Datos </td>
                                </tr>
                                <tr>
                                    <td> DATABASES['default']['PASSWORD']  </td>
                                    <td> Contraseña del usuario de la Base de Datos </td>
                                </tr>
                                <tr>
                                    <td> DATABASES['default']['HOST'] </td>
                                    <td> Host de la Base de Datos  </td>
                                </tr>                                       
                            </table>
                            <strong>Base de datos por Defecto </strong>
                            <p>
                            Para la realización de Informes de Producción Científica extraídos de los CVN cada año se clona la base de datos por defecto en un esquema “histórico” de sólo lectura.

                            Para cada base de datos/esquema se debe añadir la siguiente configuración:
                            </p>
<pre>
DATABASES['historica_2013'] = DATABASES['default'].copy()
DATABASES['historica_2013']['TEST_MIRROR'] = 'default'
DATABASES['historica_2013']['OPTIONS'] = { 
    'options': '-c search_path=schema_2013'
}
</pre>
                            <table class="table table-striped table-condensed">
                                    <tr>
                                        <th>VARIABLE</th>
                                        <th>DESCRIPCIÓN</th>
                                    </tr>
                                    <tr>
                                        <td> HISTORICAL </td>
                                        <td> Hash que relaciona un año con la configuración de su base de datos histórica </td>
                                    </tr>
                            </table>    
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Aplicación CVN -->

        <li> Settings Local de CVN (cvn/settings_local.py) </li>
        <div class="row">
            <div class="col-md-12">
                <div class="section">
                <ul class="nav nav-tabs header">
                    <li class="active">Configuración</li>
                </ul>
                    <div class="content">
                        <div class="row-fluid">
                            <table class="table table-striped table-condensed">
                                <tr>
                                    <th>VARIABLE</th>
                                    <th>DESCRIPCIÓN</th>
                                </tr>
                                <tr>
                                    <td> UNIVERSITY </td>
                                    <td> Nombre de la Entidad por defecto </td>
                                </tr>
                                <tr>
                                    <td> EXPIRY_DATE </td>
                                    <td> Fecha de Caducidad de un CVN </td>
                                </tr>
                                <tr>
                                    <td> FECYT_USER </td>
                                    <td> Usuario del Servicio de Web Services de la FECYT </td>
                                </tr>
                                <tr>
                                    <td> FECYT_PASSWORD </td>
                                    <td> Contraseña del usuario del Servicio de Web Services de la FECYT </td>
                                </tr>
                                <tr>
                                    <td> CVN_PDF_AUTHOR_NOAUT </td>
                                    <td> Nombre del autor de un CVN-PDF cuya subida no está autorizada </td>
                                </tr>                                       
                                <tr>
                                    <td> HISTORICAL_YEAR </td>
                                    <td>Obtiene el año para acceder a la base de datos histórica y mostrar el CVN-PDF del usuario GesInv-ULL empleado para subirle un CVN con toda la producción científica de la Universidad </td>
                                </tr>
                            </table>                        
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ul>
</ol>
        </div>
    </section>
        </div>
        <div class="col-md-3 sidebar" id="sidebar">




    <div class="panel panel-default panel-ull color-336699">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-external-link-square"></i> Enlaces de interés</h3>
            </div>
            <div class="panel-body">
                <ul class="nav nav-pills nav-stacked" id="links">
                    <li><a href="http://www.ull.es/" target="_blank"> Universidad de La Laguna (ULL)</a></li>
                    <li><a href="http://www.fecyt.es" target="_blank"> FECYT</a></li>
                </ul>
            </div>
    </div>
    <div class="panel panel-default panel-ull color-336699">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-copyright"></i> Licencia</h3>
            </div>
            <div class="panel-body">
                <ul class="nav nav-pills nav-stacked" id="links">
                    <li><div class="media">Este proyecto está publicado bajo la <a href="https://www.gnu.org/licenses/agpl-3.0.html">licencia AGPL3</a></div></li>
                    <li><div class="media"><img class="media-object" style="display: block; margin-left: auto; margin-right: auto;" src="images/agplv3.png"></div></li>
                </ul>
            </div>
    </div>
        </div>
    </div>
</div>
<div id="footer">
   <div class="container-fluid">
      <div class="row">
         <div class="col-xs-12">
            <ul class="address pull-left">
                <li><strong>Universidad de La Laguna</strong><br> Pabellón de Gobierno, C/ Molinos de Agua s/n. | San Cristóbal de La Laguna, Santa Cruz de Tenerife - España (38200) | Teléfono: (+34) 922 31 90 00/01</li>
            </ul>
            <ul class="list-inline text-muted pull-right">
                <li><a title="Facebook" target="_blank" href="http://www.facebook.com/universidaddelalaguna"><span class="fa fa-facebook-square"></span></a></li>
                <li><a title="Tuenti" target="_blank" href="http://www.tuenti.com/#m=Page&amp;func=index&amp;page_key=1_160_68944913"><i class="fa fa-tumblr-square"></i></a></li>
                <li><a title="Twitter" target="_blank" href="http://twitter.com/CanalULL"><i class="fa fa-twitter-square"></i></a></li>
                <li><a title="LinkedIn" target="_blank" href="http://www.linkedin.com/groups/Universidad-Laguna-2656178"><i class="fa fa-linkedin-square"></i></a></li>
                <li><a title="Página web ULL" target="_blank" href="http://www.ull.es"><i class="fa fa-globe"></i></a></li>
            </ul>
         </div>
      </div>
   </div>
</div>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="//static.ull.es/v3/dist/js/ull.min.js"></script>

</body>
</html>